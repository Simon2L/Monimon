@page "/"
@using Monimon.Logic

<PageTitle>Home</PageTitle>

<MudText Class="mt-4" Typo="Typo.h4" GutterBottom="true">@CpuTemperature</MudText>

<ServiceCard ProjectName="pi-python"></ServiceCard>


@code {
    private string CpuTemperature = "";
    private List<string> ProjectNames = ["pi-python", "safesite"];

    Timer? timer;
    protected override void OnInitialized()
    {
        timer = new Timer(async _ =>
        {
            var temp = Hardware.getTemp(0);
            CpuTemperature = temp.HasValue ? $"{temp.Value} °C" : "N/A";
            await InvokeAsync(StateHasChanged);
        }, null, 0, 10000);
    }

    private string GetStatusText(ProjectStatus status) => status switch
    {
        ProjectStatus.Active a => $"Running (Up: {a.uptime})",
        ProjectStatus.Inactive i => "Stopped",
        ProjectStatus.Failed f => $"Error: {f.error}",
        _ => "Unknown"
    };

    private Color GetStatusColor(ProjectStatus status) => status switch
    {
        ProjectStatus.Active => Color.Success,
        ProjectStatus.Inactive i => Color.Surface,
        ProjectStatus.Failed => Color.Error,
        _ => Color.Default
    };

    public void Dispose()
    {
        timer?.Dispose();
    }
}